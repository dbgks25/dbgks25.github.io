---
layout: null
permalink: /search/search.json
---

[
{% assign pages    = site.pages | where_exp: "p", "p.title" | where_exp: "p", "p.search != false" %}
{% assign posts    = site.posts | where_exp: "p", "p.title" | where_exp: "p", "p.search != false" %}
{% assign projects = site.projects | where_exp: "p", "p.title" | where_exp: "p", "p.search != false" %}
{% assign items    = pages | concat: posts | concat: projects | sort: "title" %}

{% for item in items %}
  {
    "id": "{{ forloop.index }}",
    "title": {{ item.title | jsonify }},
    "url": {{ item.url | relative_url | jsonify }},
    "date": {{ item.date | date_to_string | jsonify }},
    "content": {{ item.content | strip_html | normalize_whitespace | jsonify }},
    "summary": {{ item.summary | default: item.description | default: item.excerpt | strip_html | truncate: 150 | jsonify }},
    "tags": {% if item.collection == "projects" %}{{ item.stack | join: " " | default: "" | jsonify }}{% else %}{{ item.tags | join: " " | default: "" | jsonify }}{% endif %},
    "type": {% if item.collection == "posts" %}"post"{% elsif item.collection == "projects" %}"project"{% else %}"page"{% endif %},
    "collection": {{ item.collection | default: "" | jsonify }}
  }{% unless forloop.last %},{% endunless %}
{% endfor %}
]
